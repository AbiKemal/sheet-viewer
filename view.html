<!DOCTYPE html>
<html>
<head>
  <title>Data Peserta</title>
  <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
  <script type="text/javascript">
    google.charts.load('current', {'packages':['table']});
    google.charts.setOnLoadCallback(drawTable);

    function getQueryParam(param) {
      const urlParams = new URLSearchParams(window.location.search);
      return urlParams.get(param);
    }

    function drawTable() {
      const nama = getQueryParam("nama");
      if (!nama) {
        document.getElementById("table_div").innerHTML = "Nama peserta tidak ditemukan di URL.";
        return;
      }

      var sheetId = '1aNWfGYIqARaSmDXl0eqJ5Sy6htOgBgMTIZC1SlZA0vA';
      var sheetName = 'Sheet1'; // Ganti sesuai sheet yang sesuai
      var queryString = encodeURIComponent(`SELECT C, D, E WHERE B = '${nama}'`);

      var dataSourceUrl = `https://docs.google.com/spreadsheets/d/${sheetId}/gviz/tq?sheet=${sheetName}&headers=1&tq=${queryString}`;

      var query = new google.visualization.Query(dataSourceUrl);
      query.send(function(response) {
        if (response.isError()) {
          document.getElementById("table_div").innerHTML = 'Gagal memuat data: ' + response.getMessage();
          return;
        }

        var data = response.getDataTable();
        var table = new google.visualization.Table(document.getElementById('table_div'));
        table.draw(data, {showRowNumber: true, width: '100%', height: 'auto'});
      });
    }
  </script>
</head>
<body>
  <h2>Data Peserta</h2>
  <div id="table_div">Memuat data...</div>
</body>
</html>
